# MySQL查询优化
## 为什么要使用索引？
在不使用索引的情况，查询数据需要逐行扫描，在数据量很大的情况必然会很浪费时间。而使用索引后，通过索引能够得知匹配数据的位置，大大提高查询效率。
<div align=center>
  <img src="https://github.com/qinchunabng/ReadingNotes/blob/master/images/table_ad.png" alt="没有索引的数据表ad" title="没有索引的数据表ad"/>
  <p>没有索引的数据表ad</p>
</div>
上图是一个数据表ad，如果在没有索引的情况下，查找所有company_num为13的数据行，就需要检索表中所有的数据行，如果表很大但是仅有几个记录与搜索条件匹配，那么整个过程就很慢效率很低。但是我们如果在company_num列上建立一个索引，就不用再一行一行检索表中所有的数据行，如果查询company_num为13的行数，当搜索到company_num为14数据时，就知道后面已经没有company_num为13的数据了，这样就是提高检索效率。
这是单表查询的情况下，还有一种情况是多表联合查询，也可以通过索引的方式提高检索效率。单表里面在没有索引情况需求检索表里面所有数据行，也就是表的数据总行数，但是在多表联合查询的情况下，没有索引的情况检索的数据就是多个表中数据的笛卡尔积，这个数量将会是非常庞大的。举个栗子：假如有三个没有索引的表t1、t2和t3，且每个表中都有一列从1到1000的数据，要找出这些表所有具有相同数值所有数据行的组合，查询语句如下
<pre>
  <code>
    select * from t1 inner join t2 on t1.i1=t2.i2 inner join t2.i2=t3.i3
  </code>
</pre>
如果不用索引不全表扫面，就无法知道那些数据行包含有哪些数据。因此，必须组合所有的数据行来查找那些数据行与where字句匹配，这样的组合有1000x1000x1000种，比匹配的数据多100万倍，这是一种极大的浪费。使用索引后，查询过程将分为以下几个步骤：

1. 从数据表t1中选择第一行数据，看这个数据包含什么样的值；
2. 对数据表t2使用索引，直接找到与表t1相匹配的数据行，类似的表t3也是采用同样的操作；
3. 对数据表t1重复上面的过程，直到检查完t1表中的所有数据。

